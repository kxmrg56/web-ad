# 匿名用户广告投放生态系统（第一版）

## 一．开发的基本构想：

### 1. 广告网站：

**广告管理**: 广告管理网站为广告商提供一个完整的后台管理系统，广告商可以在平台上注册和登录，对广告进行创建、查看、修改和删除操作。广告类型包括文字广告、图片广告和视频广告，同时可以为每个广告设置分类标签，例如电子产品、时尚、美妆等，以便在不同网站中按照内容类别进行精准投放。广告商还可以设置广告投放策略，包括投放目标网站和展示频率，从而灵活管理广告资源。

**广告 API**: 平台提供 REST 风格的 API 接口，供购物网站、视频分享网站和新闻网站调用，实现广告内容的跨网站展示。通过这些接口，其他网站可以获取符合用户兴趣和分类要求的广告，同时将广告的展示和点击事件上报到广告管理平台，保证广告投放数据的完整统计。

**广告投放**: 为了实现个性化广告推荐，平台会为匿名用户生成唯一 ID，并通过 Cookie 记录用户在不同网站上的浏览兴趣。基于这些兴趣数据，广告管理平台可以返回更精准的广告内容，从而提高广告点击率和用户的观看体验，实现跨网站的个性化投放。

**广告统计**: 平台会对所有广告的展示次数和点击次数进行记录和统计，为广告商提供广告效果分析报表，包括广告曝光量、点击量和投放效果。平台还可以根据展示和点击数据实现收益结算逻辑，为不同网站计算广告分成，确保广告商、媒体网站和广告管理平台之间的收益透明和可追踪。

### 2. 购物网站：

**商品管理功能**: 建立商品分类（数码电子、食品零食、图书文具、服装鞋帽、家居用品等），商品具有名称、描述、价格、库存，商品都有标签（如"高端数码"、"休闲零食"、"畅销书籍"），便于精准推荐；商品可以加入购物车。

**用户行为跟踪与个性化推荐**: 通过Cookie为未登录用户生成唯一ID，跨站追踪用户兴趣，基于用户在新闻网站和其他合作网站的浏览历史，分析兴趣标签；首页根据用户兴趣动态推荐相关商品，实现"猜你喜欢"。

**广告集成功能**: 在首页、分类页、商品详情页预留固定广告区域，自动调用广告网站API，获取个性化广告内容；向广告平台传递用户匿名ID、当前浏览的商品分类、页面类型等信息，统计广告展示次数和点击率。

### 3. 视频网站：

**视频内容管理**: 本网站主要用于用户发布与分享视频内容，平台提供基础的视频上传与展示功能。视频文件由服务器端程序负责读取与处理，支持在播放过程中根据设定的位置暂停主视频，并自动切换到广告视频文件播放，再继续主视频播放。视频处理采用统一的 MIME 类型识别机制，确保浏览器正确解析视频流格式。系统还支持为视频设置标题、标签和分类，便于用户浏览与检索，提高内容组织效率。

**广告插播机制**: 平台内置广告插播功能，由后台程序在视频播放到指定时间后自动切入广告文件。广告内容包括短视频广告或图片广告，均以 MIME 类型区分。广告由管理员在后台配置，包括广告文件路径、插入时机和播放策略。播放端采用简单的定时逻辑与文件流拼接方式，使得广告能在不中断整体播放流程的情况下顺利切入，保证观看体验的连续性。

**视频播放接口**: 为便于前端网页调用视频内容，平台提供基于 Servlet 的视频流接口。该接口通过分段读取视频文件并输出到浏览器，实现可控的播放流程。接口会在检测到广告触发点时，自动切换至广告文件的输出流，广告播放结束后再返回主视频流。接口层同时负责正确设置 Content-Type MIME 类型，使前端 <video> 标签能正常解码与渲染视频内容。

**用户观看体验**: 为了保证用户在观看过程中的体验，系统采用浏览器原生 <video> 控件结合后端流式传输方式。前端只需请求同一个播放接口即可获得完整带广告的视频播放体验。系统还在播放页面提供基本的控制功能，如暂停、继续播放和进度显示。

### 4. 新闻网站：

**新闻内容功能**: 新闻文章列表展示，文章详情页阅读，简单的分类导航（政治、经济、体育、科技、娱乐）

**广告集成功能**: 在页面布局中预留一个固定广告div区域，页面加载时自动调用广告API获取广告内容，将返回的广告内容动态插入到广告div中，统计广告展示和点击事件。

**用户上下文采集**: 通过Cookie获取匿名用户ID（与广告平台一致），采集当前阅读的文章分类信息。

**广告集成流程**: 页面加载完成，广告div容器准备就绪，收集用户上下文（匿名ID、页面分类、区域），通过fetch API调用广告管理平台的广告接口，接收广告内容（HTML片段），将广告内容安全插入广告div，绑定广告点击事件并统计上报。

## 二．成员组成和分工：

**人数**: 4人

**专业**: 计算机科学与技术

**初步分工**:

- 字文韬：广告网站的基础设计和开发+广告接口的设计
- 张文文：购物网站的开发+广告接口的设计和广告视频搜集
- 谢云泽：视频网站的开发和设计+机动工作
- 叶君韬：新闻网站的开发+广告网站的图文资料收集

## 三．技术选型：

### 广告管理网站：

| 功能 | 技术选型 | 说明 |
|------|----------|------|
| 前端 | HTML + CSS + JavaScript | 广告商后台界面渲染、表单操作和异步调用广告 API |
| 后端 | Servlet + JSP | 广告管理、API接口、用户认证、统计逻辑 |
| 数据库 | MySQL | 存储广告信息、广告商账户、用户匿名ID、广告统计数据 |
| 用户认证 | Session + Cookie | 广告商登录认证与匿名用户识别 |
| 跨域支持 | Servlet CORS 设置 | 允许其他网站通过 JS fetch 调用广告 API |
| 部署 | Tomcat | 独立部署到服务器，提供 API 接口 |
| 版本管理 | GitHub | 团队协作、代码托管和作业提交 |

### 购物网站：

| 功能 | 技术选型 | 说明 |
|------|----------|------|
| 前端界面 | HTML + CSS + JavaScript | 商品展示、分类浏览、购物车操作，使用JS实现 |
| 后端框架 | Servlet + JSP | 商品管理、分类查询、购物车逻辑、API接口业务逻辑 |
| 数据库 | MySQL | 存储商品信息、分类数据、匿名用户行为数据、广告统计 |
| 用户追踪 | Cookie | 为匿名用户生成唯一ID，记录浏览行为和兴趣偏好 |
| 个性化推荐 | Cookie + Servlet过滤器和监听器 | 通过Cookie追踪用户浏览行为，实现跨站个性化商品推荐 |
| 广告集成 | JavaScript Fetch API + Servlet CORS设置 | 调用广告平台API，动态渲染个性化广告内容 |
| 购物车 | Cookie + Servlet Session | 临时存储用户选择的商品，基于会话的购物车管理 |
| 文件存储 | 服务器本地存储 + Servlet文件上传 | 商品图片等静态资源存储在服务器本地 |
| 部署运行 | Tomcat | 部署到Tomcat服务器，提供Web服务和API接口 |
| 版本管理 | GitHub | 代码版本控制，团队协作开发 |

### 视频网站：

| 功能 | 技术选型 | 说明 |
|------|----------|------|
| 视频内容管理 | Java Servlet、文件系统存储、本地视频文件 | 服务器端程序负责读取视频文件，通过文件流输出给前端；采用 MIME 类型识别，保证浏览器能正确解析并播放视频内容。 |
| 视频上传与分类 | JSP 表单上传、Servlet 处理、数据库 | 用户可上传视频，后台保存视频路径、标题与分类标签；数据库用于存储视频元数据，前端通过分类展示内容。 |
| 广告插播机制 | Servlet 视频流控制、视频分段读取、广告文件 | 播放主视频时根据设定的时间点切换到广告文件流，广告结束后自动回到主视频流，实现广告插播逻辑。 |
| MIME 类型识别 | URLConnection.guessContentTypeFromName或手动设置 Content-Type | 在输出视频或广告文件前设置正确的 MIME 类型，保证 <video> 标签能正常解码。 |
| 视频播放接口 | 单一播放 Servlet、Range 断点续传支持 | 前端 <video> 只需访问同一个接口；接口内部控制主视频与广告播放顺序。 |
| 前端播放页面 | HTML + <video> 标签 + 基本 CSS | 前端采用 video 控件完成播放，展示播放进度、暂停、继续等基本控制按钮。 |
| 管理员广告配置 | JSP 后台页面、Servlet 增删查改、数据库表 | 管理员可上传广告文件、设置插入时间点；系统通过数据库读取广告策略并在播放时执行。 |
| 用户观看体验 | 浏览器原生控件、流式加载 | 前端无需复杂加载逻辑，播放无明显卡顿；界面优美简洁 |

### 新闻网站：

| 功能 | 技术选型 | 说明 |
|------|----------|------|
| 前端展示 | HTML + CSS + JavaScript | 页面渲染、新闻内容展示、广告容器布局 |
| 新闻内容功能 | Servlet + JSP + JDBC | 新闻文章列表展示、文章详情页阅读、分类导航（政治/经济/体育/科技/娱乐） |
| 广告集成功能 | JavaScript fetch API + DOM操作 | 在页面布局中预留固定广告div区域，自动调用广告API获取广告内容，动态插入广告内容，统计广告展示和点击事件 |
| 用户上下文采集 | Cookie | 通过Cookie获取匿名用户ID（与广告平台一致），采集当前阅读的文章分类信息 |
| 数据存储 | MySQL | 存储新闻内容、文章分类、用户访问记录、页面统计信息 |
| 广告集成流程 | JavaScript异步编程 | 页面加载完成→广告div容器准备→收集用户上下文→fetch API调用广告接口→接收广告内容→安全插入广告div→绑定点击事件统计上报 |
| 会话管理 | Session + Cookie | 维护匿名用户会话状态，跨页面跟踪用户行为 |
| 跨域支持 | Servlet CORS设置 | 通过JS fetch跨域调用广告管理平台的API接口 |
| 部署 | Tomcat | 独立部署到服务器，与广告平台分离运行 |
| 版本管理 | GitHub | 团队协作、代码托管和作业提交 |

## 四.开发进度安排

**期中报告前**：
完成所有网站的静态页面布局，并明确四个网站之间如何通信（定义API接口）。

**最终报告**：
实现广告接口的调用，和完整的功能实现。
